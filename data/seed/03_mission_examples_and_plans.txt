[문서 제목] 미션 시나리오와 PLAN JSON 예시

[0. 공통 패턴 요약]

* 이동형 미션(“~가서 보고 와”, “확인해줘”, “전달해줘” 등)은 아래 순서를 기본으로 한다.

  1) **navigate**: 목적지로 이동.
  2) **핵심 작업**: observe_scene / deliver_object / talk_to_person 등 사용자가 요청한 행동 수행.
  3) **navigate (basecamp)**: 작업 후에는 반드시 `basecamp`로 복귀.
  4) **summarize_mission**: 전체 과정을 텍스트로 요약.
  5) (필요 시) **talk_to_person(target="user")**: “보고/알려줘” 요청이 있다면 요약을 사용자에게 말로 전달.

* “교수님께 물어보고 와” 같은 요청이라면, 목적지 `professor_office`로 이동 → 교수님과 대화 → basecamp 복귀 → summarize_mission → (보고 요청 시) talk_to_person(user)의 형태가 된다.
* 아래 예시는 모두 이 패턴을 기반으로 변형한 것이다.

[1. 미션 유형 1: 교수님께 물건 전달 후 다음 프로젝트 일정 여쭤보기]

* 사용자 자연어 요청 예시
  "교수님 방에 가서 이 물건을 전달해 드리고, 다음 프로젝트는 언제 진행하실 예정인지 여쭤봐줘."

* 추천 PLAN JSON 예시

```json
{
  "plan": [
    {
      "action": "navigate",
      "params": { "target": "professor_office" }
    },
    {
      "action": "deliver_object",
      "params": { "receiver": "professor" }
    },
    {
      "action": "talk_to_person",
      "params": {
        "target": "professor",
        "topic": "다음 프로젝트 일정 문의"
      }
    },
    {
      "action": "navigate",
      "params": { "target": "basecamp" }
    },
    {
      "action": "summarize_mission",
      "params": {}
    }
  ]
}
```

---

[2. 미션 유형 2: 복도가 시끄러운지 원인 확인 후 사용자에게 보고]

* 사용자 자연어 요청 예시
  "복도가 요즘 좀 시끄러운 것 같은데, 무슨 일이 있는지 확인해주고 나한테 알려줘."
  "복도가 왜 이렇게 시끄러운지 좀 보고 와서 말해줘."

* 추천 PLAN JSON 예시

```json
{
  "plan": [
    {
      "action": "navigate",
      "params": { "target": "corridor_center" }
    },
    {
      "action": "observe_scene",
      "params": {
        "target": "corridor_center",
        "query": "복도가 시끄러운 이유, 사람 밀집 여부, 소란스러운 행동이 있는지 확인"
      }
    },
    {
      "action": "navigate",
      "params": { "target": "basecamp" }
    },
    {
      "action": "talk_to_person",
      "params": {
        "target": "user",
        "topic": "복도가 시끄러운 원인(사람 수, 소란 행동, 행사 등)에 대한 보고"
      }
    },
    {
      "action": "navigate",
      "params": { "target": "basecamp" }
    },
    {
      "action": "summarize_mission",
      "params": {}
    }
  ]
}
```

* 설명

  * "확인해주고 나한테 알려줘", "보고 와서 말해줘"처럼 **사용자에게 다시 설명해야 하는 요청**이므로,
    관찰 후 반드시 `basecamp`로 돌아와 `user`에게 `talk_to_person`으로 보고한다.

---

[3. 미션 유형 3: 복도 조명 상태 확인 (보고 없이 현장 상태만 확인)]

* 사용자 자연어 요청 예시
  "복도에 불이 켜져 있는지 확인해줘."
  "지금 복도 불 꺼져 있는지 봐줘."

* 추천 PLAN JSON 예시

```json
{
  "plan": [
    {
      "action": "navigate",
      "params": { "target": "corridor_center" }
    },
    {
      "action": "observe_scene",
      "params": {
        "target": "corridor_center",
        "query": "복도 조명이 켜져 있는지, 일부만 꺼져 있는 구간이 있는지 확인"
      }
    },
    {
      "action": "summarize_mission",
      "params": {}
    }
  ]
}
```

* 설명

  * 여기서는 "보고 와서 말해줘", "나한테 알려줘" 같은 표현이 없으므로
    **현장 상태 확인 + 요약 + basecamp 복귀**까지만 수행하는 예시이다.
  * "복도에 불이 켜져 있는지 보고 와서 알려줘."처럼 **보고 뉘앙스**가 추가되면,
    2번 패턴과 같이 `basecamp` 복귀 후 `talk_to_person(target="user")`를 붙여야 한다.

---

[4. 미션 유형 4: 교수님께 다음 회의 일정 물어보고, 사용자에게 직접 와서 결과 알려주기]

* 사용자 자연어 요청 예시
  "교수님께 다음 회의 언제 할지 물어보고 내게 다시 알려줘."
  "다음 회의 일정 교수님께 여쭤보고, 나한테 와서 말해줘."

* 추천 PLAN JSON 예시

```json
{
  "plan": [
    {
      "action": "navigate",
      "params": { "target": "professor_office" }
    },
    {
      "action": "talk_to_person",
      "params": {
        "target": "professor",
        "topic": "다음 회의 일정 문의"
      }
    },
    {
      "action": "navigate",
      "params": { "target": "basecamp" }
    },
    {
      "action": "talk_to_person",
      "params": {
        "target": "user",
        "topic": "교수님의 다음 회의 일정 결과 보고"
      }
    },
    {
      "action": "summarize_mission",
      "params": {}
    }
  ]
}
```

* 설명

  * "내게 다시 알려줘", "나한테 와서 말해줘"는 **사용자에게 결과를 보고하라**는 의미이며,
    `fail_and_report`가 아니라 `navigate` + `talk_to_person(target="user")` 패턴으로 처리한다.

---

[5. 미션 유형 5: 이동 없이 사용자와 대화만 수행하기 (순수 LLM 대화)]

* 사용자 자연어 요청 예시

  * "나 배 아파."
  * "나 심심해. 뭐 하면 좋을까?"
  * "요즘 공부가 너무 힘들어."
  * "기분이 좀 우울한데, 이야기 좀 해줄래?"

* 특징

  * 특정 장소로 "가서", "갔다 와", "보고 와", "전달해줘" 등의 이동/행동 요청이 없다.
  * 단순히 사용자와 이야기만 나누는 대화형 미션이다.

* 추천 PLAN JSON 예시

```json
{
  "plan": [
    {
      "action": "talk_to_person",
      "params": {
        "target": "user",
        "topic": "사용자의 기분과 상태에 대해 대화하고, 위로 또는 조언을 제공"
      }
    },
    {
      "action": "summarize_mission",
      "params": {}
    }
  ]
}
```

* 설명

  * 이 유형의 미션에서는 `navigate`, `observe_scene`, `deliver_object`는 사용하지 않는다.
  * PLAN LLM은 사용자의 감정/상태를 요약한 `topic`을 만들고,
    대화 LLM이 그 `topic`을 기반으로 실제 대화를 수행하도록 설계할 수 있다.

---

[6. 미션 유형 6: 교수님께 특정 내용 여쭤보고 돌아와서 보고하기 (일반 템플릿)]

* 사용자 자연어 요청 예시

  * "교수님께 가서 우리 프로젝트 언제 하는지 여쭤봐."
  * "교수님께 로봇팔 도착했는지 여쭤보고 와."
  * "교수님께 장학금 결과가 언제 나오는지 물어봐줘."

* PLAN LLM 내부에서 사용할 요약 표현 예시

  * `{question_summary} = "다음 프로젝트 일정"`
  * `{question_summary} = "로봇팔 도착 여부"`
  * `{question_summary} = "장학금 결과 발표 시점"`

* 추천 PLAN JSON 예시

```json
{
  "plan": [
    {
      "action": "navigate",
      "params": { "target": "professor_office" }
    },
    {
      "action": "talk_to_person",
      "params": {
        "target": "professor",
        "topic": "{question_summary}에 대해 여쭤보기"
      }
    },
    {
      "action": "navigate",
      "params": { "target": "basecamp" }
    },
    {
      "action": "talk_to_person",
      "params": {
        "target": "user",
        "topic": "교수님의 \"{question_summary}\"에 대한 답변 보고"
      }
    },
    {
      "action": "summarize_mission",
      "params": {}
    }
  ]
}
```

* 설명

  * PLAN LLM은 사용자의 문장을 분석하여 `{question_summary}`를 짧은 한국어 명사구로 요약한 뒤,
    위와 같은 패턴으로 PLAN을 생성할 수 있다.
  * 프로젝트 일정, 물품 도착 여부 등 다양한 교수님 질의 미션에 재사용 가능한 일반형 템플릿이다.

---

[7. 미션 유형 7: 특정 위치의 사람 수 / 사람 존재 여부 / 특정 행동 여부 확인 후 사용자에게 보고]

* 사용자 자연어 요청 예시

  * "복도에 몇 명 있는지 보고 와서 알려줘."
  * "복도에 사람 있는지 보고 와."
  * "화장실 앞에 누구 있는지 확인하고 나한테 알려줘."
  * "라운지에 앉아 있는 사람 있는지 보고 와줘."
  * "물 마시고 있는 사람이 있는지 보고 와서 말해줘."

* 위치 매핑 예시

  * "복도" → `corridor_center`
  * "화장실 앞" → `restroom_front`
  * "라운지", "휴게실" → `lounge`

* 추천 PLAN JSON 예시
  *(보고 요청이므로 항상 basecamp 복귀 + 사용자 보고를 포함한다.)*

```json
{
  "plan": [
    {
      "action": "navigate",
      "params": { "target": "<location_id>" }
    },
    {
      "action": "observe_scene",
      "params": {
        "target": "<location_id>",
        "query": "해당 위치에서 사람 수, 사람 존재 여부, 특정 행동(예: 물을 마시는 사람)이 있는지 확인"
      }
    },
    {
      "action": "navigate",
      "params": { "target": "basecamp" }
    },
    {
      "action": "talk_to_person",
      "params": {
        "target": "user",
        "topic": "<location_id>에서 관찰한 사람 수 및 상황에 대한 보고"
      }
    },
    {
      "action": "summarize_mission",
      "params": {}
    }
  ]
}
```

* 설명

  * 이 미션 유형은 **항상 “보고 와 / 알려줘” 뉘앙스**를 포함하고 있다고 가정한다.
  * 따라서 `observe_scene` 후 반드시 `basecamp`로 돌아와 `user`에게 결과를 설명하는 패턴만 사용하고,
    **“현장에서 확인만 하는 경우” 패턴은 사용하지 않는다.**

---

[8. 미션 유형 8: 복도를 순찰하고 이상 상황이 있는지 확인]

* 사용자 자연어 요청 예시

  * "복도를 순찰하고 와."
  * "복도 쪽 이상 없는지 한 바퀴 돌아줘."
  * "복도랑 라운지 쪽에 이상한 일 없는지 확인해줘."

* 기본 아이디어

  * 복도 중앙(`corridor_center`)과 라운지(`lounge`) 등 여러 지점을 순차적으로 방문하여 관찰한다.
  * 마지막에는 `basecamp`로 복귀한다.
  * 사용자에게 직접 말로 보고해 달라는 표현이 추가되면, `talk_to_person(target="user")`를 덧붙인다.

* 추천 PLAN JSON 예시 (순찰 + 내부 요약까지만 하는 기본형)

```json
{
  "plan": [
    {
      "action": "navigate",
      "params": { "target": "corridor_center" }
    },
    {
      "action": "observe_scene",
      "params": {
        "target": "corridor_center",
        "query": "복도 중앙의 사람 수, 소란 여부, 장애물 또는 이상 상황 확인"
      }
    },
    {
      "action": "navigate",
      "params": { "target": "lounge" }
    },
    {
      "action": "observe_scene",
      "params": {
        "target": "lounge",
        "query": "휴게 공간의 사람 수, 혼잡도, 이상 상황 확인"
      }
    },
    {
      "action": "navigate",
      "params": { "target": "basecamp" }
    },
    {
      "action": "summarize_mission",
      "params": {}
    }
  ]
}
```

* 필요 시 사용자 보고까지 포함하는 변형

  * 사용자 자연어 예시:
    "복도 순찰하고 돌아와서 나한테 상황 알려줘."

```json
{
  "plan": [
    {
      "action": "navigate",
      "params": { "target": "corridor_center" }
    },
    {
      "action": "observe_scene",
      "params": {
        "target": "corridor_center",
        "query": "복도 중앙의 사람 수, 소란 여부, 장애물 또는 이상 상황 확인"
      }
    },
    {
      "action": "navigate",
      "params": { "target": "lounge" }
    },
    {
      "action": "observe_scene",
      "params": {
        "target": "lounge",
        "query": "휴게 공간의 사람 수, 혼잡도, 이상 상황 확인"
      }
    },
    {
      "action": "navigate",
      "params": { "target": "basecamp" }
    },
    {
      "action": "talk_to_person",
      "params": {
        "target": "user",
        "topic": "복도와 라운지 순찰 결과(사람 수, 소란 여부, 이상 상황)에 대한 보고"
      }
    },
    {
      "action": "summarize_mission",
      "params": {}
    }
  ]
}
```

* 설명

  * "돌아와서 알려줘", "보고해줘" 등의 표현이 포함되면
    반드시 `talk_to_person(target="user")`를 포함한 두 번째 패턴을 사용한다.

---

[9. PLAN LLM을 위한 가이드라인]

9.1 이동 여부 판단

* 사용자의 요청에 아래와 같은 표현이 **없으면**,
  `"이동 없음 + 대화만"`으로 간주할 수 있다.

  * "가서", "~에 가서", "갔다 와", "보고 와", "확인해줘", "갖다줘", "전달해줘", "갖다 드리고 와", "순찰하고 와"
* 이 경우, 기본 패턴은 다음과 같다.

  * `talk_to_person(target="user")` (+ 필요시 `summarize_mission`)
  * 예: 미션 유형 5

9.2 이동이 포함된 요청 분류

* 교수님 관련:

  * "교수님께", "교수님 방에 가서", "교수님께 여쭤봐" 등이 포함된 경우
  * → `professor_office`로 `navigate` 후 `talk_to_person(target="professor")` 사용
  * 물건 전달이 함께 언급되면 `deliver_object`도 포함
  * 예: 미션 유형 1, 4, 6
* 환경/상황 관찰:

  * "복도", "복도에 불", "복도가 시끄럽다", "복도에 몇 명", "화장실 앞", "라운지" 등
  * → 해당 위치 ID로 `navigate` 후 `observe_scene` 사용
  * 예: 미션 유형 2, 3, 7, 8

9.3 사용자에게 결과를 다시 알려줘야 하는 경우

* "내게 다시 알려줘", "나한테 와서 말해줘", "결과 알려줘", "보고해줘",
  "보고 와서 알려줘", "보고 와서 말해줘" 등 **보고/대화 요청 키워드**가 있으면,
  PLAN의 마지막 부분에 다음 패턴을 추가한다.

  1. `navigate` → `target: "basecamp"`
  2. `talk_to_person` → `target: "user"`, `topic`에 결과 요약 내용
  3. 필요시 `summarize_mission`
* 예: 미션 유형 2, 4, 6, 7, 8(두 번째 예시)

9.4 안전 및 실패 처리

* 복도 순찰, 사람 수 확인 등에서 "사람이 너무 많아 안전하게 이동할 수 없음"과 같은 상황이 예상되면,
  별도의 안전 가이드라인 문서를 참고한다.
* PLAN LLM은 필요 시 마지막에 `fail_and_report` 액션을 추가할 수 있다.

```json
{
  "action": "fail_and_report",
  "params": {
    "reason": "복도에 사람이 지나치게 많아 안전하게 이동할 수 없음"
  }
}
```

9.5 액션 사용 규칙 요약

* PLAN은 항상 `02_robot_capabilities_and_actions` 문서에 정의된 액션 이름만 사용한다.

  * `navigate`, `deliver_object`, `observe_scene`, `talk_to_person`, `summarize_mission`, `fail_and_report`
* 이동이 필요한 미션의 기본 패턴:

  1. `navigate` (필요한 위치로 이동)
  2. `observe_scene` / `deliver_object` / `talk_to_person` 등 실제 행동
  3. 필요 시 `navigate`로 복귀
  4. **보고 요청이 있다면** `talk_to_person(target="user")`로 결과 보고
  5. `summarize_mission`으로 마무리
* 이동이 필요 없는 미션은:

  * `talk_to_person(target="user")` (+ `summarize_mission`)만 포함한다.

---
